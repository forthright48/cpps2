function apiLogin(req, res, next) {
  const regexApi = /^\/api\/v1/g;
  if (regexApi.exec(req.originalUrl)) {
    if (req.session && req.session.login) return next();
    return res.status(401).json({
      status: 401,
      message: 'Unauthorized: You need to login',
    });
  } else {
    return next();
  }
}

function login(req, res, next) {
  const sess = req.session || {};
  if (sess.login) return next();
  else {
    req.flash('info', 'Please login and try again');
    return res.status(401).redirect('/user/login');
  }
};

module.exports = {
  login,
  apiLogin,
};
